{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://ai-tool-sync.dev/schemas/mcp.schema.json",
  "title": "MCP Configuration",
  "description": "Schema for .ai-tool-sync/mcp.yaml - Model Context Protocol server definitions",
  "type": "object",
  "required": ["servers"],
  "properties": {
    "version": {
      "type": "string",
      "description": "Configuration version",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "default": "1.0.0"
    },
    "servers": {
      "type": "object",
      "description": "MCP server definitions keyed by server name",
      "additionalProperties": {
        "$ref": "#/$defs/server"
      }
    }
  },
  "additionalProperties": false,
  "$defs": {
    "server": {
      "type": "object",
      "description": "MCP server configuration",
      "oneOf": [
        { "$ref": "#/$defs/commandServer" },
        { "$ref": "#/$defs/urlServer" }
      ]
    },
    "commandServer": {
      "type": "object",
      "description": "Command-based MCP server (stdio transport)",
      "required": ["command"],
      "properties": {
        "command": {
          "type": "string",
          "description": "Command to execute (e.g., 'npx', 'node', 'python')"
        },
        "args": {
          "type": "array",
          "description": "Command arguments",
          "items": { "type": "string" },
          "default": []
        },
        "env": {
          "type": "object",
          "description": "Environment variables for the server process",
          "additionalProperties": { "type": "string" }
        },
        "cwd": {
          "type": "string",
          "description": "Working directory for the server process"
        },
        "description": {
          "type": "string",
          "description": "Human-readable description of the server"
        },
        "enabled": {
          "type": "boolean",
          "description": "Whether the server is enabled",
          "default": true
        },
        "targets": {
          "type": "array",
          "description": "Target tools for this server (cursor, claude, factory)",
          "items": {
            "type": "string",
            "enum": ["cursor", "claude", "factory"]
          },
          "default": ["cursor", "claude", "factory"]
        }
      },
      "additionalProperties": false
    },
    "urlServer": {
      "type": "object",
      "description": "URL-based MCP server (SSE transport)",
      "required": ["url"],
      "properties": {
        "url": {
          "type": "string",
          "description": "Server URL endpoint",
          "format": "uri"
        },
        "headers": {
          "type": "object",
          "description": "HTTP headers to send with requests",
          "additionalProperties": { "type": "string" }
        },
        "description": {
          "type": "string",
          "description": "Human-readable description of the server"
        },
        "enabled": {
          "type": "boolean",
          "description": "Whether the server is enabled",
          "default": true
        },
        "targets": {
          "type": "array",
          "description": "Target tools for this server (cursor, claude, factory)",
          "items": {
            "type": "string",
            "enum": ["cursor", "claude", "factory"]
          },
          "default": ["cursor", "claude", "factory"]
        }
      },
      "additionalProperties": false
    }
  }
}

